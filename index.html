<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Mi Lista de Películas y Series</title>
  <style>
    body { font-family:"Segoe UI",Arial,sans-serif; background:#0d253f; color:white; margin:20px;}
    h1 { text-align:center; color:#01b4e4; font-size:2.5em;}
    .menu { display:flex; justify-content:center; gap:20px; margin:20px 0;}
    .menu button { background:#01b4e4; border:none; padding:10px 20px; border-radius:5px; color:white; cursor:pointer; font-weight:bold;}
    .menu button:hover { background:#0288a7;}
    h2 { color:#01b4e4; font-size:2em; margin-top:20px;}
    .contenedor { display:flex; flex-wrap:wrap; justify-content:center;}
    .pelicula { display:inline-block; margin:20px; text-align:center; width:200px; position:relative;}
    .pelicula img { width:100%; border-radius:8px; box-shadow:0 4px 10px rgba(0,0,0,0.5);}
    .pelicula p { margin-top:8px; font-size:1.05em; color:white; font-weight:normal;}
    .rating-circle { position:absolute; bottom:0; left:0; transform:translate(-40%,-40%); width:48px; height:48px;}
    .rating-circle svg { transform:rotate(-90deg);}
    .rating-text { position:absolute; top:50%; left:50%; transform:translate(-50%,-50%); font-size:0.8em; font-weight:bold; color:white;}
    .progress { transition:stroke-dashoffset 1.5s ease;}
    .popup { 
      position:absolute; 
      bottom:30%; left:0; 
      width:250%; height:60%; 
      background:rgba(0,0,0,0.7); 
      backdrop-filter:blur(8px);
      color:white; 
      opacity:0; 
      transition:opacity 0.3s ease; 
      border-radius:8px; 
      padding:10px; 
      box-sizing:border-box; 
      font-size:0.9em; 
      overflow-y:auto; 
      z-index:1000;
    }
    .pelicula:hover .popup { opacity:1;}
    .popup h3 { margin:0; color:#01b4e4; font-size:1em; font-weight:normal;}
    .popup p { margin:2px 0; font-weight:normal;}
    .paginacion { text-align:center; margin:20px;}
    .paginacion button { background:#01b4e4; border:none; padding:8px 15px; border-radius:5px; color:white; cursor:pointer; margin:0 10px;}
    .paginacion button:hover { background:#0288a7;}
  </style>
</head>
<body>
  <h1>Mi Lista de Películas y Series</h1>

  <!-- Menú superior -->
  <div class="menu">
    <button onclick="mostrarPeliculas()">Películas</button>
    <button onclick="mostrarSeries()">Series</button>
    <button onclick="mostrarGeneros()">Géneros</button>
    <button onclick="mostrarRecientes()">Recientes</button>
  </div>

  <h2 id="tituloSeccion">Películas</h2>
  <div id="contenedor" class="contenedor"></div>

  <!-- Paginación -->
  <div class="paginacion">
    <button onclick="paginaAnterior()">Anterior</button>
    <span id="paginaActual">1</span>
    <button onclick="paginaSiguiente()">Siguiente</button>
  </div>

  <script>
    const apiKey = "86f6772a666a8617d6b629fa9a4b3c62";  
    const movieIds = [238,603,597,496243,27205,155,680,122,13,550,424,862,314]; // ejemplo
    const seriesIds = [1399,60735,1668,1412,456,4629,66732,1100]; // ejemplo

    let peliculasData = [];
    let seriesData = [];
    let pagina = 1;
    let itemsPorPagina = 20;
    let modo = "peliculas"; // "peliculas", "series", "generos", "recientes"
    let modoAnterior = "peliculas";

    async function getDirector(id) {
      const res = await fetch(`https://api.themoviedb.org/3/movie/${id}/credits?api_key=${apiKey}`);
      const data = await res.json();
      const director = data.crew.find(c => c.job === "Director");
      return director ? director.name : "Desconocido";
    }

    function renderItem(data, type, containerId, director="") {
      const rating = data.vote_average * 10;
      const radius = 20;
      const circumference = 2 * Math.PI * radius;
      const offset = circumference - (rating/100)*circumference;
      let color = rating>=70 ? "#21d07a" : rating>=40 ? "#d2d531" : "#db2360";
      const genres = data.genres.map(g=>g.name).join(", ");

      const div = document.createElement("div");
      div.className="pelicula";
      div.innerHTML=`
        <a href="https://www.themoviedb.org/${type}/${data.id}" target="_blank">
          <img src="https://image.tmdb.org/t/p/w300${data.poster_path}" alt="${data.title||data.name}">
          <p>${data.title||data.name}</p>
          <div class="rating-circle">
            <svg width="48" height="48">
              <circle cx="24" cy="24" r="${radius}" stroke="#444" stroke-width="3" fill="black"/>
              <circle class="progress" cx="24" cy="24" r="${radius}" stroke="${color}" stroke-width="3" fill="transparent"
                stroke-dasharray="${circumference}" stroke-dashoffset="${circumference}"/>
            </svg>
            <div class="rating-text">${data.vote_average.toFixed(1)}</div>
          </div>
          <div class="popup">
            <h3>${data.title||data.name}</h3>
            <p><strong>Estreno:</strong> ${data.release_date||data.first_air_date}</p>
            ${type==="movie"?`<p><strong>Director:</strong> ${director}</p>`:""}
            <p><strong>Género:</strong> ${genres}</p>
            <p>${data.overview}</p>
          </div>
        </a>`;
      document.getElementById(containerId).appendChild(div);
      setTimeout(()=>{div.querySelector(".progress").setAttribute("stroke-dashoffset",offset);},100);
    }

    async function cargarPeliculas() {
      peliculasData = [];
      for(let id of movieIds){
        const res = await fetch(`https://api.themoviedb.org/3/movie/${id}?api_key=${apiKey}&language=es-ES`);
        const data = await res.json();
        const director = await getDirector(id);
        peliculasData.push({...data,director});
      }
    }

    async function cargarSeries() {
      seriesData = [];
      for(let id of seriesIds){
        const res = await fetch(`https://api.themoviedb.org/3/tv/${id}?api_key=${apiKey}&language=es-ES`);
        const data = await res.json();
        seriesData.push(data);
      }
    }

    function mostrarPeliculas(){
      modo="peliculas"; modoAnterior="peliculas"; pagina=1;
      document.getElementById("tituloSeccion").textContent="Películas";
      mostrarPagina();
    }

    function mostrarSeries(){
      modo="series"; modoAnterior="series"; pagina=1;
      document.getElementById("tituloSeccion").textContent="Series";
      mostrarPagina();
    }

    function mostrarGeneros(){
      modo="generos";
      document.getElementById("tituloSeccion").textContent="Géneros";
      document.getElementById("contenedor").innerHTML="<p>Lista de géneros aquí...</p>";
    }

    function mostrarRecientes(){
      modo="recientes";
      document.getElementById("tituloSeccion").textContent="Recientes";
      document.getElementById("contenedor").innerHTML="";
      let lista = (modoAnterior==="series"?seriesData:peliculasData);
      lista.sort((a,b)=>(b.release_date||b.first_air_date).localeCompare(a.release_date||a.first_air_date));
      lista.slice(0,20).forEach(item=>renderItem(item,modoAnterior==="series"?"tv":"movie","contenedor",item.director||""));
    }

    function mostrarPagina(){
      document.getElementById("contenedor").innerHTML="";
      let lista = (modo==="peliculas"?peliculasData:seriesData);
      let inicio = (pagina-1)*itemsPorPagina;
      let fin = inicio + itemsPorPagina;
      let paginaItems = lista.slice(inicio, fin);

      paginaItems.forEach(item=>{
        renderItem(item, modo==="series"?"tv":"movie", "contenedor", item.director||"");
      });

      document.getElementById("paginaActual").textContent = pagina;
    }

    function paginaAnterior(){
      if(pagina>1){
        pagina--;
        mostrarPagina();
      }
    }

    function paginaSiguiente(){
      let lista = (modo==="peliculas"?peliculasData:seriesData);
      if(pagina*itemsPorPagina < lista.length){
        pagina++;
        mostrarPagina();
      }
    }

    // Inicialización: cargar películas y series al inicio
    (async function(){
      await cargarPeliculas();
      await cargarSeries();
      mostrarPeliculas(); // arranca mostrando películas
    })();
  </script>
</body>
</html>
